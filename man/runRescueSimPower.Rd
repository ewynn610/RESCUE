% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runPowerAnalysis.R
\name{runRescueSimPower}
\alias{runRescueSimPower}
\title{Run Power Simulations for rescueSim Data}
\usage{
runRescueSimPower(
  baseParams,
  scenarios,
  deFunction,
  nSim = 1,
  padjThresh = 0.05,
  returnFDR = FALSE,
  conditions = NULL,
  saveSimPath = NULL,
  saveDePath = NULL,
  verbose = TRUE,
  ...
)
}
\arguments{
\item{baseParams}{A \code{RescueSimParams} object containing
baseline simulation parameters.}

\item{scenarios}{A data.frame specifying simulation settings to vary.
Column names must match slots in the \code{RescueSimParams} object.
Each row defines one scenario.}

\item{deFunction}{A function that takes a \code{SingleCellExperiment} object
simulated using \code{\link{simRescueData}} and returns a data.frame with
columns \code{gene} and \code{padj}.}

\item{nSim}{Integer specifying the number of simulations to run per scenario.
Default is 1.}

\item{padjThresh}{Significance threshold to call DE (e.g., FDR < 0.05).
Default is 0.05.}

\item{returnFDR}{Logical. Whether to calculate and return the false discovery rate (FDR) along with power.
Default is TRUE.}

\item{conditions}{A character vector of length 2 specifying the conditions to
compare (e.g., \code{c("time1", "time3_group1")}). If \code{NULL} (default),
the comparison is inferred based on available conditions in \code{rowData},
comparing the baseline condition (e.g., \code{"time0"}, \code{"group0"}, or
\code{"time0_group0"}) to the final condition (e.g., last timepoint, or
group 1 at the final timepoint).}

\item{saveSimPath}{Optional path to directory where simulated SCE objects
should be saved as .rds files. If NULL (default), simulated data is not saved.}

\item{saveDePath}{Optional path to directory where DE result data.frames
should be saved as .rds files. If NULL (default), results are not saved.}

\item{verbose}{Logical. Whether to print progress messages. Default is TRUE.}

\item{...}{Additional arguments passed to \code{deFunction()}.}
}
\value{
A data.frame with one row per simulation replicate, including:
\itemize{
  \item Power: proportion of truly DE genes detected
  \item FDR: false discovery rate (if \code{returnFDR = TRUE})
  \item Scenario settings and simulation number
  \item The reference and comparison condition used
}

Optionally, simulated datasets and DE results can be saved to disk.
}
\description{
Simulate scRNA-seq data under different experimental settings and compute
statistical power to detect differential expression (DE) using a user-specified DE function.
}
\details{
For each scenario, this function simulates \code{nSim} datasets based on the,
supplied settings, applies the user-supplied DE method, and
calculates power as the proportion of true DE genes correctly identified.
DE status is determined by assessing equality in the  simulated log2 fold-change values
between conditions. False discovery rate (FDR) is optionally
calculated as the proportion of genes called DE that are not truly DE.
}
\seealso{
\code{\link{isDEbetweenConditions}}, \code{\link{simRescueData}},
\code{\link{updateRescueSimParams}}, \code{\link{RescueSimParams}}
}
